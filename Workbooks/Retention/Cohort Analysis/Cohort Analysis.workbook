{
    "version": "Notebook/1.0",
    "isLocked": true,
    "items": [
        {
            "type": 1,
            "content": {
                "json": "# <a name=\"cohort-analysis\"></a>Analiza kohortowa\n\nAnaliza kohortowa mierzy liczbƒô u≈ºytkownik√≥w, kt√≥rzy powracajƒÖ, aby wykonaƒá jedno z dzia≈Ça≈Ñ `RetainingActivities` w danym przedziale czasu po wykonaniu jednego z dzia≈Ça≈Ñ `CohortingActivities` w Twojej aplikacji ‚Äî z podzia≈Çem wed≈Çug wybranego wymiaru. Na przyk≈Çad mo≈ºesz mierzyƒá liczbƒô u≈ºytkownik√≥w, kt√≥rzy wr√≥cili do u≈ºywania Twojej aplikacji w 10 dniu od dnia, w kt√≥rym po raz pierwszy jƒÖ pobrali. Trend utrzymania dla dni 1‚Äì10 bƒôdzie dla Ciebie wskazaniem atrakcyjno≈õci aplikacji. \n\nAnaliza kohortowƒÖ jest podobna do analizy utrzymania dla N dnia lub dla przedzia≈Çu i r√≥≈ºni siƒô tylko sposobem definiowania kohorty. \n\nTego typu analiza dobrze nadaje siƒô dla gier i innych rodzaj√≥w aplikacji, w przypadku kt√≥rych pr√≥bujesz zachƒôciƒá u≈ºytkownik√≥w do wykszta≈Çcenia codziennego nawyku. Analiza kohortowa pozwala zobaczyƒá r√≥≈ºnice w utrzymania u≈ºytkownik√≥w w r√≥≈ºnych standardowych wymiarach, takich jak kraj, wersja aplikacji itp., lub wymiarach niestandardowych, takich jak \"Klient Premium\" lub ‚ÄûNazwa lotu w grupie eksperymentu‚Äù."
            },
            "conditionalVisibility": null
        },
        {
            "type": 1,
            "content": {
                "json": "### <a name=\"activity-selection\"></a>Wyb√≥r dzia≈Çania\nPrzy u≈ºyciu tych p√≥l mo≈ºesz ustawiƒá dzia≈Çania odpowiadajƒÖce interesujƒÖcym dzia≈Çaniom u≈ºytkownik√≥w. W sekcji `Understanding Cohort Analysis Parameters` na dole opisano szczeg√≥≈Çowo te parametry."
            },
            "conditionalVisibility": null
        },
        {
            "type": 9,
            "content": {
                "version": "KqlParameterItem/1.0",
                "query": "",
                "crossComponentResources": [],
                "parameters": [
                    {
                        "id": "97ae2ae5-ec95-455b-bac2-36caf2db61db",
                        "version": "KqlParameterItem/1.0",
                        "name": "CohortingActivities",
                        "type": 2,
                        "isRequired": true,
                        "multiSelect": true,
                        "quote": "'",
                        "delimiter": ",",
                        "query": "let events = union customEvents, pageViews\n| where timestamp >= ago(7d)\n| summarize Count = count() by name;\nlet top3 = events\n| top 3 by Count desc\n| summarize makelist(name);\nevents\n| order by Count desc\n| project Id=name, Title=name, Selected=iff(name in (top3), true, false)\n| union (\ndatatable(Id:string, Title:string, Selected:boolean)[\n'*', 'All Events and Page Views', false\n]\n)"
                    },
                    {
                        "name": "CohortingFilters",
                        "id": "94bacf68-78db-4755-8a40-c2702dea4018",
                        "type": 1,
                        "value": ""
                    },
                    {
                        "id": "6cb4afed-7dac-4608-892b-154f4943ddb6",
                        "version": "KqlParameterItem/1.0",
                        "name": "RetainingActivities",
                        "type": 2,
                        "isRequired": true,
                        "multiSelect": true,
                        "quote": "'",
                        "delimiter": ",",
                        "query": "union customEvents, pageViews\n| where timestamp >= ago(7d)\n| summarize count() by name\n| order by count_ desc\n| project Id=name, Title=name, Selected=false\n| union (\ndatatable(Id:string, Title:string, Selected:boolean)[\n'#', 'Same as cohorting activities', true,\n'*', 'All Events and Page Views', false\n]\n)"
                    },
                    {
                        "id": "0cc5211a-557e-4648-9569-1236bf16559f",
                        "version": "KqlParameterItem/1.0",
                        "name": "RetainingFilters",
                        "type": 1,
                        "isRequired": false,
                        "query": "datatable(x:int)[ 1 ]\r\n| extend retainingFilter = iff('#' in ({RetainingActivities}), '{CohortingFilters}', '')\r\n| project retainingFilter",
                        "isHiddenWhenLocked": false
                    }
                ],
                "style": "pills",
                "resourceType": "microsoft.insights/components"
            },
            "conditionalVisibility": null
        },
        {
            "type": 1,
            "content": {
                "json": "## <a name=\"cohort-analysis-parameters\"></a>Parametry analizy kohortowej\nPrzy u≈ºyciu tych p√≥l mo≈ºesz dostosowaƒá ustawienia utrzymania."
            },
            "conditionalVisibility": null
        },
        {
            "type": 9,
            "content": {
                "version": "KqlParameterItem/1.0",
                "query": "",
                "crossComponentResources": [],
                "parameters": [
                    {
                        "id": "1c53914e-0c06-4944-b2b8-fd4abaeb2f9f",
                        "version": "KqlParameterItem/1.0",
                        "name": "CohortType",
                        "type": 2,
                        "description": null,
                        "isRequired": true,
                        "multiSelect": null,
                        "query": "datatable(value:string, text:string)[\n'itemType', '‚ùå None',\n'name', 'üìõ Activity',\n'cloud_RoleInstance', 'üñ•Ô∏è Machine',\n'client_CountryOrRegion', 'üìç Country or Region',\n'client_StateOrProvince', 'üìç State or Province',\n'client_City', 'üìç City',\n'client_Browser', 'üåê Client Browser',\n'client_OS', 'Ô∏èÔ∏èüñ•Ô∏è Client Operating System',\n'client_Model', 'üì± Client Model',\n'application_Version', '‚ö™ Application Version',\n'operation_Name', '‚ö™ Operation',\n]\n| union (union pageViews, customEvents\n| where timestamp >= ago(1d)\n| where name in ({CohortingActivities}) or '*' in ({CohortingActivities})\n| project customDimensions \n| summarize schema = buildschema(customDimensions) \n| mvexpand schema\n| extend e = extract(@'{\"(.+)\":.+}', 1, tostring(schema))\n| project text = strcat('‚ùÑÔ∏è ', e), value = strcat('customDimensions[\"', e, '\"]'))",
                        "value": "name"
                    },
                    {
                        "id": "e62098ae-ac3f-4800-8e62-3e7d9a052e56",
                        "version": "KqlParameterItem/1.0",
                        "name": "RetentionPeriod",
                        "type": 2,
                        "description": "1d: Codziennie, 7d: Co tydzie≈Ñ 30/28d: Co miesiƒÖc",
                        "isRequired": true,
                        "multiSelect": null,
                        "query": "datatable(id:string, text:string)[\n'1d', 'Daily',\n'7d', 'Weekly',\n'28d', 'Monthly (28 days)', \n'30d', 'Monthly (30 days)'\n]",
                        "value": "7d"
                    },
                    {
                        "id": "fa4b29d9-bfc1-46e3-98f1-3cba05afbea3",
                        "version": "KqlParameterItem/1.0",
                        "name": "PeriodsToAnalyze",
                        "type": 1,
                        "description": "Liczba okres√≥w kohorty do analizy",
                        "isRequired": true,
                        "value": "4"
                    },
                    {
                        "id": "7912aca9-1688-4886-aec1-838c68131e25",
                        "version": "KqlParameterItem/1.0",
                        "name": "BasedOn",
                        "type": 2,
                        "description": null,
                        "isRequired": true,
                        "multiSelect": null,
                        "query": "datatable(v:string, t:string)[\r\n'user_Id', 'Anonymous Users',\r\n'user_AuthenticatedId', 'Authenticated Users'\r\n]",
                        "isHiddenWhenLocked": false,
                        "value": "user_Id"
                    },
                    {
                        "id": "f6511ffa-e2ea-4a34-ad2e-454856288bd5",
                        "version": "KqlParameterItem/1.0",
                        "name": "Show",
                        "type": 2,
                        "isRequired": true,
                        "isHiddenWhenLocked": false,
                        "typeSettings": {
                            "additionalResourceOptions": []
                        },
                        "jsonData": "[\r\n    { \"value\": \"RetentionRate\", \"label\": \"Retention Rate\", \"selected\": true},\r\n    { \"value\": \"RetainedCount\", \"label\": \"Retained Users\", \"selected\": false},\r\n    { \"value\": \"UserCount\", \"label\": \"Potentially Retainable Users\", \"selected\": false}\r\n]",
                        "timeContextFromParameter": null
                    }
                ],
                "style": "pills",
                "resourceType": "microsoft.insights/components"
            },
            "conditionalVisibility": null
        },
        {
            "type": 1,
            "content": {
                "json": "## <a name=\"cohort-analysis-table\"></a>Tabela analizy kohortowej"
            },
            "conditionalVisibility": null
        },
        {
            "type": 3,
            "content": {
                "version": "KqlItem/1.0",
                "query": "let periodsToAnalyze = {PeriodsToAnalyze};\nlet cohortSize = {RetentionPeriod};\nlet retainingActivities = iff(({RetainingActivities}) in ('#'), dynamic([{CohortingActivities}]), dynamic([{RetainingActivities}]));\nlet cohortUnit = case(cohortSize == 30d or cohortSize == 28d, \"month\", cohortSize == 7d, \"week\", \"day\");\nlet timeRange = startofday(now()) - case(cohortSize == 30d or cohortSize == 28d, startofmonth(now() - periodsToAnalyze * cohortSize), cohortSize == 7d, startofweek(now() - periodsToAnalyze * cohortSize), startofday(now() - periodsToAnalyze * cohortSize));\nlet data = union customEvents, pageViews\n| where user_Id != \"undefined\"\n| where timestamp > startofday(now() - timeRange);\nlet cohorts = data\n| where name in ({CohortingActivities}) or '*' in ({CohortingActivities})\n| extend Cohort = iff('{CohortType}' == 'itemType', 'Overall', iff({CohortType} == '', 'Unknown', {CohortType})) // reusing itemType to indicate no segmentation\n| summarize EarliestInCohort = min(startofday(timestamp)) by user_Id, Cohort\n| summarize NewUsers = hll(user_Id) by EarliestInCohort, Cohort;\nlet usage = data\n| where name in (retainingActivities) or '*' in (retainingActivities)\n| extend Cohort = iff('{CohortType}' == 'itemType', 'Overall', iff({CohortType} == '', 'Unknown', {CohortType})) // reusing itemType to indicate no segmentation\n| summarize UsersInCohort = hll(user_Id) by Day = startofday(timestamp), Cohort;\ncohorts\n| extend RetentionEvaluationDay = range(EarliestInCohort + 1d, now(), 1d)\n| mvexpand RetentionEvaluationDay to typeof(datetime) limit 1000\n| extend RetentionWeek = bin((RetentionEvaluationDay - EarliestInCohort) / cohortSize, 1)\n| join kind=inner\n(\n    usage\n)\non $left.RetentionEvaluationDay == $right.Day, Cohort\n| project EarliestInCohort, Cohort, RetentionWeek, EvaluationDayUsers = UsersInCohort, NewUsers\n| summarize Users = hll_merge(EvaluationDayUsers), NewUsers = hll_merge(NewUsers) by EarliestInCohort, Cohort, RetentionWeek\n| evaluate dcount_intersect(NewUsers, Users)\n| project EarliestInCohort, Cohort, RetentionWeek, CohortUserCount = s0, CohortRetainedCount = s1\n| summarize UserCount = sum(CohortUserCount), RetainedCount = sum(CohortRetainedCount) by Cohort, RetentionWeek\n| extend RetentionRate = round(100.0 * RetainedCount / UserCount, 2)\n| order by RetentionWeek asc, UserCount desc\n| project Cohort, RetentionWeek, Metric = {Show}\n| extend RetentionWeek = case(RetentionWeek == 0, strcat(\"<1 \", cohortUnit), strcat(\"+\", toint(RetentionWeek), \" \", cohortUnit))\n| serialize\n| evaluate pivot(RetentionWeek, sum(Metric))\n\n\n\n\n",
                "showQuery": false,
                "size": 0,
                "aggregation": 0,
                "showAnnotations": false,
                "showAnalytics": false,
                "timeContextFromParameter": null,
                "resourceType": "microsoft.insights/components",
                "gridSettings": {
                    "formatters": [
                        {
                            "columnMatch": "week|month|day",
                            "formatter": 8,
                            "formatOptions": {
                                "min": 0,
                                "max": null,
                                "palette": "green"
                            }
                        }
                    ]
                }
            },
            "conditionalVisibility": null
        },
        {
            "type": 1,
            "content": {
                "json": "## <a name=\"interpreting-the-table\"></a>Interpretowanie tabeli\nW tej sekcji pokazano, jak odczytywaƒá i interpretowaƒá tabelƒô utrzymania. Poni≈ºsza sekcja przedstawia wiersz z tygodniowego raportu utrzymania, kt√≥ry spr√≥bujemy odczytaƒá:\n"
            },
            "conditionalVisibility": null
        },
        {
            "type": 3,
            "content": {
                "version": "KqlItem/1.0",
                "query": "datatable(Cohort:string, Users:int, ['<1 week']:int, ['+1 week']:int, ['+2 week']:int, ['+3 week']:int, ['+4 week']:int)[ \r\n'Add to Cart', 1000, 50, 30, 20, 15, 10\r\n]\r\n",
                "showQuery": false,
                "size": 0,
                "aggregation": 0,
                "showAnnotations": false,
                "showAnalytics": false,
                "timeContextFromParameter": null,
                "resourceType": "microsoft.insights/components",
                "gridSettings": {
                    "formatters": [
                        {
                            "columnMatch": "week",
                            "formatter": 8,
                            "formatOptions": {
                                "min": 0,
                                "max": null,
                                "palette": "green"
                            }
                        }
                    ]
                }
            },
            "conditionalVisibility": null
        },
        {
            "type": 1,
            "content": {
                "json": "| Kolumna | Wyja≈õnienie | Interpretacja w przyk≈Çadzie |\n| ----- | :----- | :----- |\n| Kohorta | Identyfikuje kryteria wyznaczania kohorty okre≈õlone przez parametr CohortType. | Ten wiersz wyja≈õnia zachowanie zwiƒÖzane z utrzymaniem u≈ºytkownik√≥w, kt√≥rzy u≈ºyli zdarzenia ‚ÄûDodaj do koszyka‚Äù (Add to Cart). |\n| ≈ÅƒÖczna liczba u≈ºytkownik√≥w | Liczba unikatowych u≈ºytkownik√≥w, kt√≥rzy u≈ºyli funkcji dodawania do koszyka  | 1000 unikatowych u≈ºytkownik√≥w doda≈Ço element do koszyka w Twojej aplikacji |\n| < 1 tydzie≈Ñ | Odsetek u≈ºytkownik√≥w w kohorcie, kt√≥rzy powr√≥cili w okresie od 1 do 6 dni po u≈ºyciu funkcji ‚ÄûDodaj do koszyka‚Äù (u≈ºywanie jej ponownie w tym samym dniu nie liczy siƒô jako utrzymanie)  | 50% lub 500 u≈ºytkownik√≥w wr√≥ci≈Ço do u≈ºywania aplikacji w pierwszym tygodniu po tym, jak dodali element do swojego koszyka |\n| + 1 tydzie≈Ñ | Odsetek u≈ºytkownik√≥w w kohorcie, kt√≥rzy wr√≥cili do u≈ºywania aplikacji w okresie od 7 do 13 dnia po u≈ºyciu funkcji ‚ÄûDodaj do koszyka‚Äù  | 30% lub 300 u≈ºytkownik√≥w wr√≥ci≈Ço do u≈ºywania aplikacji tydzie≈Ñ p√≥≈∫niej |\n| + N tydzie≈Ñ | Odsetek u≈ºytkownik√≥w kohorty, kt√≥rzy wr√≥cili w N-tym tygodniu po u≈ºyciu funkcji ‚ÄûDodaj do koszyka‚Äù  | 15% lub 150 u≈ºytkownik√≥w, gdy N = 3  |\n\n\n\n\n"
            },
            "conditionalVisibility": null
        },
        {
            "type": 1,
            "content": {
                "json": "## <a name=\"understanding-cohort-analysis-parameters\"></a>Interpretacja parametr√≥w analizy kohortowej\n| Parametr | U≈ºywana do |\n| ----- | ----- |\n| Typ kohorty | Wymiar, wed≈Çug kt√≥rego majƒÖ byƒá dzielone liczby utrzymania |\n| Okres utrzymania | Okres do u≈ºycia w obliczeniach utrzymania. Mo≈ºe to byƒá Codziennie, Co tydzie≈Ñ lub Co miesiƒÖc |\n| Okresy do analizy  | Liczba okres√≥w utrzymania do analizy.  |\n| Dzia≈Çania wyznaczajƒÖce kohortƒô  | Dzia≈Çania, kt√≥re wybierajƒÖ kohortƒô u≈ºytkownik√≥w. Przyk≈Çad: U≈ºytkownicy, kt√≥rzy u≈ºyli zdarzenia *Czytanie recenzji produktu* (dzia≈Çanie wyznaczajƒÖce kohortƒô). |\n| Dzia≈Çania utrzymujƒÖce  | Dzia≈Çania, kt√≥re wskazujƒÖ na utrzymanie u≈ºytkownika w≈ÇƒÖczonego do kohorty wybranego powy≈ºej. Przyk≈Çad: U≈ºytkownicy, kt√≥rzy u≈ºyli zdarzenia *Czytanie recenzji produktu* (dzia≈Çanie wyznaczajƒÖce kohortƒô) i powr√≥cili, aby u≈ºyƒá funkcji *Zakup produktu* (dzia≈Çanie utrzymujƒÖce). |\n| Filtry wyznaczania kohorty/utrzymania  | Fragment zapytania analizy s≈Çu≈ºƒÖcy do dalszego filtrowania dzia≈Çania wyznaczajƒÖcego kohortƒô. Przyk≈Çad: *&#124; where application_Version = '1.0'* |\n| Show  | Metryka do wizualizacji w tabeli. *Wska≈∫nik utrzymania* pokazuje wska≈∫nik powrotu u≈ºytkownik√≥w dla okresu w kolumnie. *Utrzymani u≈ºytkownicy* to surowa liczba utrzymanych u≈ºytkownik√≥w dla danego okresu. *U≈ºytkownicy potencjalnie mo≈ºliwi do utrzymania* to liczba u≈ºytkownik√≥w, kt√≥rzy potencjalnie mogli byƒá utrzymani dla tego okresu. |\n"
            },
            "conditionalVisibility": null
        },
        {
            "type": 1,
            "content": {
                "json": "## <a name=\"what-is-a-week-for-a-user\"></a>Czym jest tydzie≈Ñ dla u≈ºytkownika?\nNajkr√≥cej m√≥wiƒÖc, jest on unikatowy dla ka≈ºdego u≈ºytkownika. Nasza analiza traktuje oddzielnie okno utrzymania ka≈ºdego u≈ºytkownika, zapewniajƒÖc dok≈Çadny widok jego rzeczywistego zachowania w aplikacji. \n\nRozwa≈ºmy poni≈ºszy przyk≈Çad dw√≥ch u≈ºytkownik√≥w, X i Y: \n\n| U≈ºytkownik | Pierwsze u≈ºycie aplikacji | Tygodnie dla u≈ºytkownika |\n| ----- | :----- | :----- |\n| X | 3 kwietnia | t1 = 10 kwietnia, t2 = 17 kwietnia, t3 = 24 kwietnia  |\n| Tak | 5 kwietnia | t1 = 12 kwietnia, t2 = 19 kwietnia, t3 = 26 kwietnia  |\n\nKa≈ºdy u≈ºytkownik otrzymuje oddzielne okno utrzymania. A wiƒôc je≈õli obaj u≈ºytkownicy powr√≥cili 18 kwietnia, jest to uznawane za u≈ºycie w tygodniu 2 dla u≈ºytkownika X, a za u≈ºycie w tygodniu 1 dla u≈ºytkownika Y. \n\nUmo≈ºliwia to normalizacjƒô ich u≈ºycia aplikacji w oknie utrzymania, dziƒôki czemu wyglƒÖda, jakby wszyscy u≈ºytkownicy w kohorcie u≈ºywali aplikacji tego samego dnia. To pozwala na lepszƒÖ analizƒô i por√≥wnanie zachowania u≈ºytkownik√≥w."
            },
            "conditionalVisibility": null
        },
        {
            "type": 1,
            "content": {
                "json": "## <a name=\"related-workbook-templates\"></a>PowiƒÖzane szablony skoroszyt√≥w\n* Utrzymanie ‚Äî okres N\n* Utrzymanie ‚Äî bez ogranicze≈Ñ\n* Utrzymanie ‚Äî przedzia≈Ç"
            },
            "conditionalVisibility": null
        }
    ],
    "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}